%% Exercise 4
n=20;
%    1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19  20
D=[  0 144 114 105  31 109 135 132  85  79 158  20  73 162 127 190 156  58  87  71;
   144   0 144 181 147  76 195  73  64 114 220 135  71  18  39  60  37 101  62 146;
   114 144   0  49  86 169  51  78 130  42  76  94 114 154 105 151 125 137  94  46;
   105 181  49   0  73 189  31 124 152  67  52  88 135 195 146 197 169 147 123  40;
   31  147  86  73   0 128 104 119  97  57 126  17  82 164 122 184 151  80  85  40;
   109  76 169 189 128   0 212 126  38 128 238 112  54  92  95 137 110  51  77 148;
   135 195  51  31 104 212   0 129 174  85  26 118 157 206 157 201 176 173 141  67;
   132  73  78 124 119 126 129   0  92  65 153 115  84  80  35  73  47 118  55  98;
    85  64 130 152  97  38 174  92   0  90 200  82  17  82  66 120 89   36  39 112;
    79 114  42  67  57 128  85  65  90   0 111  59  73 128  80 137 106  95  57  33;
   158 220  76  52 126 238  26 153 200 111   0 141 183 231 182 224 201 198 167  91;
    20 135  94  88  17 112 118 115  82  59 141   0  67 153 114 177 142  63  75  52;
    73  71 114 135  82  54 157  84  17  73 183  67   0  90  64 123  89  35  28  95;
   162  18 154 195 164  92 206  80  82 128 231 153  90   0  49  47  35 119  79 161;
   127  39 105 146 122  95 157  35  66  80 182 114  64  49   0  62  28  99  40 113;
   190  60 151 197 184 137 201  73 120 137 224 177 123  47  62   0  34 156 102 170;
   156  37 125 169 151 110 176  47  89 106 201 142  89  35  28  34   0 123  68 139;
    58 101 137 147  80  51 173 118  36  95 198  63  35 119  99 156 123   0  63 106;
    87  62  94 123  85  77 141  55  39  57 167  75  28  79  40 102  68  63   0  85;
    71 146  46  40  40 148  67  98 112  33  91  52  95 161 113 170 139 106  85   0];

[~,n] = size(D);                   % The matrix is n by n, where n = # nodes.
intree = [1];  nintree=1;          % intree= nodes selected. nintree= #intree
k = 0;                             % k is the number of edges selected
notintree = [2:n]';nnotintree=n-1; % notintree= nodes not selected. nnotintree=#notintree 
 
cost = [];
S = [];
E = [];
while nintree < n
% for p=1:5
  mincost = Inf;                            
  for i=1:nintree              
    for j=1:nnotintree
      ni = intree(i);
      nj = notintree(j);
      if D(ni,nj) < mincost 
        mincost = D(ni,nj);
        ei = ni;
        ej = nj;  % Save nodes and edge selected
      end
    end
  end
  S = [S, ei];
  E = [E, ej];
  cost = [cost D(ei,ej)];
  intree = [intree,ej];
  nintree = nintree+1;
  notintree(notintree==ej) = [];
  nnotintree = nnotintree-1;
end
from_to = [S;E]
cost
final_cost = sum(cost)


T = array2table(D)
T2 = uitable(T)